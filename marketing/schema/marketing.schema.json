{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://mcp-tool-shop.github.io/mcpt-marketing/schema/marketing.schema.json",
  "title": "MarketIR Schema",
  "description": "Deterministic marketing intermediate representation for MCP Tool Shop tools.",

  "$defs": {
    "schemaVersion": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Semver version of the schema this document conforms to."
    },

    "toolId": {
      "type": "string",
      "pattern": "^tool\\.[a-z0-9-]+$"
    },
    "audienceId": {
      "type": "string",
      "pattern": "^aud\\.[a-z0-9-]+$"
    },
    "claimId": {
      "type": "string",
      "pattern": "^claim\\.[a-z0-9-]+\\.[a-z0-9-]+$"
    },
    "evidenceId": {
      "type": "string",
      "pattern": "^ev\\.[a-z0-9-]+\\.[a-z0-9-]+\\.v\\d+$"
    },
    "messageId": {
      "type": "string",
      "pattern": "^msg\\.[a-z0-9-]+\\.[a-z0-9-]+$"
    },
    "campaignId": {
      "type": "string",
      "pattern": "^camp\\.[a-z0-9-]+\\.[a-z0-9-]+$"
    },

    "claimStatus": {
      "type": "string",
      "enum": ["proven", "aspirational", "deprecated"]
    },
    "evidenceType": {
      "type": "string",
      "enum": ["image", "text", "report", "video", "link"]
    },
    "messageTone": {
      "type": "string",
      "enum": ["technical", "pragmatic", "playful", "executive"]
    },
    "messageChannel": {
      "type": "string",
      "enum": ["web", "readme", "hn", "x", "linkedin", "newsletter", "presskit"]
    },

    "pressContactMethod": {
      "type": "string",
      "enum": ["email", "x-dm", "linkedin", "github-issue", "form"]
    },

    "pressContact": {
      "type": "object",
      "required": ["method", "value"],
      "properties": {
        "method": { "$ref": "#/$defs/pressContactMethod" },
        "value": {
          "type": "string",
          "description": "Contact value (URL, email, handle)."
        },
        "label": {
          "type": "string",
          "description": "Human-readable label for this contact method."
        },
        "notes": { "type": "string" }
      },
      "additionalProperties": false
    },

    "pressQuote": {
      "type": "object",
      "required": ["text"],
      "properties": {
        "text": {
          "type": "string",
          "maxLength": 500,
          "description": "Approved quote text."
        },
        "attribution": {
          "type": "string",
          "description": "Who said this."
        },
        "role": {
          "type": "string",
          "description": "Role or title of the person quoted."
        },
        "claimRefs": {
          "type": "array",
          "items": { "$ref": "#/$defs/claimId" },
          "description": "Claims this quote supports."
        }
      },
      "additionalProperties": false
    },

    "pressComparable": {
      "type": "object",
      "required": ["target", "distinction"],
      "properties": {
        "target": {
          "type": "string",
          "description": "What this tool is similar to."
        },
        "distinction": {
          "type": "string",
          "description": "How it differs (honest, not dismissive)."
        },
        "notes": { "type": "string" }
      },
      "additionalProperties": false
    },

    "pressPartnerOffer": {
      "type": "object",
      "required": ["type", "description"],
      "properties": {
        "type": {
          "type": "string",
          "enum": ["demo", "co-announcement", "integration", "early-access", "case-study"]
        },
        "description": {
          "type": "string",
          "description": "What you are offering."
        },
        "constraints": {
          "type": "string",
          "description": "Any limitations or conditions."
        }
      },
      "additionalProperties": false
    },

    "targetingOrgType": {
      "type": "string",
      "enum": ["org", "user"]
    },

    "targetingSeedRepo": {
      "type": "object",
      "required": ["owner", "repo"],
      "properties": {
        "owner": {
          "type": "string",
          "minLength": 1,
          "description": "GitHub owner (org or user)."
        },
        "repo": {
          "type": "string",
          "minLength": 1,
          "description": "GitHub repo name."
        },
        "notes": { "type": "string" }
      },
      "additionalProperties": false
    },

    "targetingBlock": {
      "type": "object",
      "description": "Optional targeting spec for partner/integrator discovery. Drives the target list generator.",
      "properties": {
        "keywords": {
          "type": "array",
          "items": { "type": "string", "minLength": 1 },
          "minItems": 1,
          "description": "Search keywords for GitHub readme/description matching."
        },
        "topics": {
          "type": "array",
          "items": { "type": "string", "minLength": 1 },
          "minItems": 1,
          "description": "GitHub repo topics to search for."
        },
        "languages": {
          "type": "array",
          "items": { "type": "string", "minLength": 1 },
          "description": "Programming languages to filter by."
        },
        "orgTypes": {
          "type": "array",
          "items": { "$ref": "#/$defs/targetingOrgType" },
          "description": "Filter by GitHub owner type."
        },
        "exclusions": {
          "type": "array",
          "items": { "type": "string", "minLength": 1 },
          "description": "GitHub owners or repos to exclude from results."
        },
        "seedRepos": {
          "type": "array",
          "items": { "$ref": "#/$defs/targetingSeedRepo" },
          "description": "Known repos to use for similarity expansion."
        }
      },
      "additionalProperties": false
    },

    "pressBlock": {
      "type": "object",
      "description": "Optional press/partner data for a tool. Enables press pages, outreach packs, and partner bundles.",
      "properties": {
        "boilerplate": {
          "type": "object",
          "properties": {
            "projectDescription": {
              "type": "string",
              "description": "Extended project description for press use."
            },
            "founderBio": {
              "type": "string",
              "description": "Team or founder bio."
            },
            "preferredNouns": {
              "type": "array",
              "items": { "type": "string" },
              "description": "Preferred terms for the tool (e.g. tool, CLI, indexer)."
            },
            "forbiddenPhrases": {
              "type": "array",
              "items": { "type": "string" },
              "description": "Phrases to never use in press/marketing (e.g. AI-powered, revolutionary)."
            }
          },
          "additionalProperties": false
        },
        "contacts": {
          "type": "array",
          "items": { "$ref": "#/$defs/pressContact" }
        },
        "quotes": {
          "type": "array",
          "items": { "$ref": "#/$defs/pressQuote" },
          "maxItems": 6
        },
        "comparables": {
          "type": "array",
          "items": { "$ref": "#/$defs/pressComparable" }
        },
        "partnerOffers": {
          "type": "array",
          "items": { "$ref": "#/$defs/pressPartnerOffer" }
        }
      },
      "additionalProperties": false
    },

    "constraints": {
      "type": "object",
      "description": "Soft advisory constraints for a channel or context.",
      "properties": {
        "maxChars": {
          "type": "integer",
          "minimum": 1
        },
        "maxSentences": {
          "type": "integer",
          "minimum": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false
    },

    "claim": {
      "type": "object",
      "required": ["id", "status", "statement"],
      "properties": {
        "id": { "$ref": "#/$defs/claimId" },
        "status": { "$ref": "#/$defs/claimStatus" },
        "statement": {
          "type": "string",
          "description": "A falsifiable claim about the tool."
        },
        "evidenceRefs": {
          "type": "array",
          "items": { "$ref": "#/$defs/evidenceId" },
          "description": "Required when status is proven."
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "if": {
        "properties": { "status": { "const": "proven" } }
      },
      "then": {
        "required": ["evidenceRefs"],
        "properties": {
          "evidenceRefs": { "minItems": 1 }
        }
      }
    },

    "antiClaim": {
      "type": "object",
      "required": ["statement"],
      "properties": {
        "statement": {
          "type": "string",
          "description": "What the tool does NOT do. Prevents misuse and builds trust."
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false
    },

    "message": {
      "type": "object",
      "required": ["id", "channel", "tone", "text", "claimRefs"],
      "properties": {
        "id": { "$ref": "#/$defs/messageId" },
        "channel": { "$ref": "#/$defs/messageChannel" },
        "tone": { "$ref": "#/$defs/messageTone" },
        "text": {
          "type": "string",
          "description": "The message content."
        },
        "claimRefs": {
          "type": "array",
          "items": { "$ref": "#/$defs/claimId" },
          "minItems": 1,
          "description": "Every message must trace to at least one claim."
        },
        "constraints": { "$ref": "#/$defs/constraints" },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false
    },

    "tool": {
      "type": "object",
      "required": [
        "schemaVersion",
        "id",
        "name",
        "positioning",
        "audienceRefs",
        "claims",
        "antiClaims",
        "messages"
      ],
      "properties": {
        "schemaVersion": { "$ref": "#/$defs/schemaVersion" },
        "id": { "$ref": "#/$defs/toolId" },
        "name": {
          "type": "string"
        },
        "positioning": {
          "type": "object",
          "required": ["oneLiner", "valueProps"],
          "properties": {
            "oneLiner": {
              "type": "string",
              "description": "One sentence that explains the tool."
            },
            "valueProps": {
              "type": "array",
              "items": { "type": "string" },
              "minItems": 1,
              "description": "Key value propositions."
            }
          },
          "additionalProperties": false
        },
        "audienceRefs": {
          "type": "array",
          "items": { "$ref": "#/$defs/audienceId" },
          "minItems": 1
        },
        "claims": {
          "type": "array",
          "items": { "$ref": "#/$defs/claim" },
          "minItems": 1
        },
        "antiClaims": {
          "type": "array",
          "items": { "$ref": "#/$defs/antiClaim" },
          "minItems": 1
        },
        "messages": {
          "type": "array",
          "items": { "$ref": "#/$defs/message" },
          "minItems": 1
        },
        "press": { "$ref": "#/$defs/pressBlock" },
        "targeting": { "$ref": "#/$defs/targetingBlock" }
      },
      "additionalProperties": false
    },

    "audience": {
      "type": "object",
      "required": ["schemaVersion", "id", "name", "description", "painPoints"],
      "properties": {
        "schemaVersion": { "$ref": "#/$defs/schemaVersion" },
        "id": { "$ref": "#/$defs/audienceId" },
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "painPoints": {
          "type": "array",
          "items": { "type": "string" },
          "minItems": 1
        }
      },
      "additionalProperties": false
    },

    "evidence": {
      "type": "object",
      "required": ["id", "type", "format", "sha256", "bytes", "provenance"],
      "properties": {
        "id": { "$ref": "#/$defs/evidenceId" },
        "type": { "$ref": "#/$defs/evidenceType" },
        "format": {
          "type": "string",
          "description": "MIME type or file extension."
        },
        "path": {
          "type": "string",
          "description": "Relative path within the repo."
        },
        "url": {
          "type": "string",
          "format": "uri",
          "description": "External URL if evidence is not local."
        },
        "sha256": {
          "type": "string",
          "pattern": "^[a-f0-9]{64}$"
        },
        "bytes": {
          "type": "integer",
          "minimum": 0
        },
        "provenance": {
          "type": "object",
          "required": ["generator", "sourceCommit"],
          "properties": {
            "generator": {
              "type": "string",
              "description": "Script or human that produced this artifact."
            },
            "sourceCommit": {
              "type": "string",
              "description": "Git commit SHA that produced the evidence."
            },
            "notes": {
              "type": "string"
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false,
      "anyOf": [{ "required": ["path"] }, { "required": ["url"] }]
    },

    "campaignPhase": {
      "type": "object",
      "required": ["name", "channels"],
      "properties": {
        "name": {
          "type": "string"
        },
        "channels": {
          "type": "array",
          "items": { "$ref": "#/$defs/messageChannel" },
          "minItems": 1
        },
        "messageRefs": {
          "type": "array",
          "items": { "$ref": "#/$defs/messageId" }
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false
    },

    "campaign": {
      "type": "object",
      "required": ["schemaVersion", "id", "name", "toolRef", "audienceRefs", "phases"],
      "properties": {
        "schemaVersion": { "$ref": "#/$defs/schemaVersion" },
        "id": { "$ref": "#/$defs/campaignId" },
        "name": {
          "type": "string"
        },
        "toolRef": { "$ref": "#/$defs/toolId" },
        "audienceRefs": {
          "type": "array",
          "items": { "$ref": "#/$defs/audienceId" },
          "minItems": 1
        },
        "phases": {
          "type": "array",
          "items": { "$ref": "#/$defs/campaignPhase" },
          "minItems": 1
        }
      },
      "additionalProperties": false
    },

    "fileRef": {
      "type": "object",
      "required": ["ref"],
      "properties": {
        "ref": {
          "type": "string",
          "description": "Relative path from marketing/data/ to the file."
        }
      },
      "additionalProperties": false
    },

    "index": {
      "type": "object",
      "required": ["schemaVersion", "tools", "audiences", "campaigns"],
      "properties": {
        "schemaVersion": { "$ref": "#/$defs/schemaVersion" },
        "tools": {
          "type": "array",
          "items": { "$ref": "#/$defs/fileRef" }
        },
        "audiences": {
          "type": "array",
          "items": { "$ref": "#/$defs/fileRef" }
        },
        "campaigns": {
          "type": "array",
          "items": { "$ref": "#/$defs/fileRef" }
        }
      },
      "additionalProperties": false
    }
  }
}
